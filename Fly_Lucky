local main = Instance.new("ScreenGui")
local Frame = Instance.new("Frame")
local menuFrame = Instance.new("Frame")
local toggleMenuButton = Instance.new("TextButton")
local up = Instance.new("TextButton")
local down = Instance.new("TextButton")
local onof = Instance.new("TextButton")
local TextLabel = Instance.new("TextLabel")
local plus = Instance.new("TextButton")
local speed = Instance.new("TextLabel")
local mine = Instance.new("TextButton")
local closebutton = Instance.new("TextButton")
local mini = Instance.new("TextButton")
local mini2 = Instance.new("TextButton")

main.Name = "main"
main.Parent = game.Players.LocalPlayer:WaitForChild("PlayerGui")
main.ZIndexBehavior = Enum.ZIndexBehavior.Sibling
main.ResetOnSpawn = false

Frame.Parent = main
Frame.BackgroundColor3 = Color3.fromRGB(163, 255, 137)
Frame.BorderColor3 = Color3.fromRGB(103, 221, 213)
Frame.Position = UDim2.new(0.1, 0, 0.38, 0)
Frame.Size = UDim2.new(0, 190, 0, 250)
Frame.Active = true
Frame.Draggable = true

menuFrame.Parent = Frame
menuFrame.Visible = false
menuFrame.BackgroundColor3 = Color3.fromRGB(200, 200, 200)
menuFrame.Position = UDim2.new(0, 0, 0.1, 0)
menuFrame.Size = UDim2.new(1, 0, 0.7, 0)

toggleMenuButton.Parent = Frame
toggleMenuButton.BackgroundColor3 = Color3.fromRGB(255, 200, 0)
toggleMenuButton.Size = UDim2.new(0, 45, 0, 28)
toggleMenuButton.Position = UDim2.new(0, 0, 0, 210)
toggleMenuButton.Font = Enum.Font.SourceSans
toggleMenuButton.Text = "Menu"
toggleMenuButton.TextColor3 = Color3.fromRGB(0, 0, 0)
toggleMenuButton.TextSize = 14

-- Function to toggle the menu visibility
local function toggleMenu()
    menuFrame.Visible = not menuFrame.Visible
end

toggleMenuButton.MouseButton1Click:Connect(toggleMenu)

-- Create buttons for flying controls
local function createButton(name, text, bgColor, pos, parent)
    local button = Instance.new("TextButton")
    button.Name = name
    button.Parent = parent
    button.BackgroundColor3 = bgColor
    button.Size = UDim2.new(0, 44, 0, 28)
    button.Position = pos
    button.Font = Enum.Font.SourceSans
    button.Text = text
    button.TextColor3 = Color3.fromRGB(0, 0, 0)
    button.TextSize = 14
    return button
end

up = createButton("up", "UP", Color3.fromRGB(79, 255, 152), UDim2.new(0.25, 0, 0.1, 0), menuFrame)
down = createButton("down", "DOWN", Color3.fromRGB(215, 255, 121), UDim2.new(0.25, 0, 0.3, 0), menuFrame)
onof = createButton("onof", "Fly", Color3.fromRGB(255, 249, 74), UDim2.new(0.25, 0, 0.5, 0), menuFrame)
plus = createButton("plus", "+", Color3.fromRGB(133, 145, 255), UDim2.new(0.25, 0, 0.7, 0), menuFrame)
mine = createButton("mine", "-", Color3.fromRGB(123, 255, 247), UDim2.new(0.25, 0, 0.9, 0), menuFrame)

-- Create speed label
speed.Parent = menuFrame
speed.BackgroundColor3 = Color3.fromRGB(255, 85, 0)
speed.Position = UDim2.new(0.5, 0, 0.5, 0)
speed.Size = UDim2.new(0, 44, 0, 28)
speed.Font = Enum.Font.SourceSans
speed.Text = "1"
speed.TextColor3 = Color3.fromRGB(0, 0, 0)
speed.TextScaled = true

-- Close button
closebutton.Name = "Close"
closebutton.Parent = Frame
closebutton.BackgroundColor3 = Color3.fromRGB(225, 25, 0)
closebutton.Font = Enum.Font.SourceSans
closebutton.Size = UDim2.new(0, 45, 0, 28)
closebutton.Text = "X"
closebutton.TextSize = 30
closebutton.Position = UDim2.new(0.85, 0, 0, 0)

-- Minimize and restore buttons
mini.Name = "minimize"
mini.Parent = Frame
mini.BackgroundColor3 = Color3.fromRGB(192, 150, 230)
mini.Font = Enum.Font.SourceSans
mini.Size = UDim2.new(0, 45, 0, 28)
mini.Text = "-"
mini.TextSize = 40
mini.Position = UDim2.new(0.1, 0, 0, 0)

mini2.Name = "minimize2"
mini2.Parent = Frame
mini2.BackgroundColor3 = Color3.fromRGB(192, 150, 230)
mini2.Font = Enum.Font.SourceSans
mini2.Size = UDim2.new(0, 45, 0, 28)
mini2.Text = "+"
mini2.TextSize = 40
mini2.Position = UDim2.new(0.1, 0, 0, 0)
mini2.Visible = false

-- Variables
local speeds = 1
local flying = false

-- Close the GUI
closebutton.MouseButton1Click:Connect(function()
    main:Destroy()
end)

-- Minimize and restore functionality
mini.MouseButton1Click:Connect(function()
    Frame.Size = UDim2.new(0, 190, 0, 40)
    menuFrame.Visible = false
    mini.Visible = false
    mini2.Visible = true
end)

mini2.MouseButton1Click:Connect(function()
    Frame.Size = UDim2.new(0, 190, 0, 250)
    mini2.Visible = false
    mini.Visible = true
end)

-- Fly toggle functionality
onof.MouseButton1Click:Connect(function()
    flying = not flying
    if flying then
        -- Add flying logic here
        onof.Text = "Stop"
    else
        -- Stop flying logic here
        onof.Text = "Fly"
    end
end)

-- Control speed functionality
plus.MouseButton1Click:Connect(function()
    speeds = speeds + 1
    speed.Text = tostring(speeds)
end)

mine.MouseButton1Click:Connect(function()
    if speeds > 1 then
        speeds = speeds - 1
        speed.Text = tostring(speeds)
    end
end)

-- Additional logic for flying (up and down)
up.MouseButton1Click:Connect(function()
    -- Logic to move up
end)

down.MouseButton1Click:Connect(function()
    -- Logic to move down
end)

game:GetService("Players").LocalPlayer.CharacterAdded:Connect(function(char)
    wait(0.7)
    game.Players.LocalPlayer.Character.Humanoid.PlatformStand = false
    game.Players.LocalPlayer.Character.Animate.Disabled = false 
end)

-- Notification
game:GetService("StarterGui"):SetCore("SendNotification", { 
    Title = "Fly GUI V3",
    Text = "By me_ozone and Quandale The Dinglish XII#3550",
    Icon = "rbxthumb://type=Asset&id=5107182114&w=150&h=150"
})
